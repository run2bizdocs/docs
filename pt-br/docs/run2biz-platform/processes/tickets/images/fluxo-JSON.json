{"idFluxo":null,"nomeFluxo":"FastTicketFlow","descricao":"Fast Ticket Flow","nomeClasseFluxo":"br.com.centralit.citcorpore.bpm.negocio.ExecucaoSolicitacao","idTipoFluxo":751,"versao":"1.0","variaveis":"","conteudoXml":null,"dataInicio":"2018-10-05 00:00:00 AM PDT","dataFim":null,"idTarefa":null,"criar":null,"executar":null,"delegar":null,"suspender":null,"acaoFluxo":null,"usuarioDestino":null,"identificador":"FastTicketFlow_v1.0","idInstanciaFluxo":null,"inicioFluxo":{"idFluxo":1001,"nome":"Início","documentacao":null,"idDesenho":null,"idType":1,"shortName":"desenhoFluxo.elemento.inicio","elementType":"ElementoFluxoInicioDTO","elementName":"desenhoFluxo.elemento.inicio","group":1,"groupSequence":1,"hasEdge":false,"adjustable":false,"viewOnToolbar":true,"viewProperties":false,"iconWidth":0,"imageName":"StartEvent.png","iconName":"StartEvent_icon.png","propertiesTabs":[{"id":0,"name":"abaElementoFluxo.identificacao"}],"properties":[{"id":"nome","tab":0,"title":"citcorpore.comum.nome","type":"TEXT","subtype":"","ngShow":"","defaultValue":null,"maxLength":50,"width":10,"height":null,"required":true,"identifier":true,"dependencies":[],"options":null},{"id":"documentacao","tab":0,"title":"citcorpore.comum.descricao","type":"EDITOR","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null}],"displayIdentifier":false,"attachToBoundary":[0],"incomingRule":2,"outgoingRule":0,"hasBoundary":false,"identifierOnCenter":false,"tip":"","defaultTab":0,"idSubType":null,"idElemento":2951,"multiplasInstancias":null,"identificador":null,"acaoEntrada":null,"idAcaoEntrada":null,"acaoSaida":null,"idAcaoSaida":null,"tipoInteracao":null,"url":null,"formulario":null,"versaoFormEspecifica":null,"versaoForm":null,"template":null,"permiteEscalar":null,"permiteDelegar":null,"permiteAlterarSituacao":null,"permiteAlterarDados":null,"habilitaNotificacaoEmail":null,"visao":null,"interacao":null,"grupos":null,"usuarios":null,"nomeFluxoEncadeado":null,"script":null,"idRegraNegocio":null,"emiteExcecao":null,"modeloEmail":null,"configCaixaPostal":null,"idCaixaPostal":null,"textoEmail":null,"templateNotificacao":null,"prazoAlerta":null,"intervalo":null,"expressaoCRON":null,"condicaoDisparo":null,"contabilizaSLA":null,"percExecucao":null,"tarefaAprovacao":null,"destinatariosEmail":null,"nomeConexaoBD":null,"nomeObjetoBD":null,"tipoSQL":null,"nomeSQL":null,"jsonEntrada":null,"jsonSaida":null,"executaEntradaNull":null,"recuperaMuitosPraUm":null,"recuperaUmPraMuitos":null,"nomeFluxoEsi":null,"exigeConfirmacao":null,"restTipoParametro":null,"restMetodoHttp":null,"restServicoBuilder":null,"restUrl":null,"restEncode":null,"restTimeout":null,"restVariavelStatus":null,"restParametros":null,"restVariavelRetorno":null,"nomeVariavel":null,"valorVariavel":null,"tipoSolicitacao":null,"solicitante":null,"grupoDirecionamento":null,"relacionada":null,"idContrato":null,"contrato":null,"idServico":null,"servico":null,"idAcordoNivelServico":null,"acordoNivelServicoSLA":null,"impacto":null,"urgencia":null,"objetosBuilder":null,"descricao":null,"contratoDto":null,"servicoDto":null,"acordoNivelServicoDto":null,"posX":128,"posY":68,"largura":32,"altura":32,"label":null,"icone":null,"imagem":null,"larguraPadrao":null,"alturaPadrao":null,"borda":false,"ajustavel":false,"tipoElemento":null,"subTipo":null,"lstPropriedades":null,"propriedades":null,"sequencias":null,"propriedades_serializadas":null,"idElementoBuilder":null,"atribuiAcompanhamento":null,"colAcoes":[],"colAtribuicoes":[],"colConhecimentos":null,"regraNegocioDto":null,"acaoEntradaDto":null,"acaoSaidaDto":null,"idWorkspace":null,"dataVersao":null,"usuario":null,"senha":null,"texto":null,"idElementoOrigem":null,"idPool":null,"replace":false,"ownerElement":null,"height":32,"description":null,"width":32},"colVariaveis":[""],"elemento_serializado":null,"sequencia":null,"elementos_serializados":null,"sequencias_serializadas":null,"linhaAtual":null,"acao":null,"idProcessoNegocio":null,"idProcessoNegocioBuilder":null,"processoNegocioDto":null,"colElementos":null,"colFinalizacoes":null,"colSequenciamentos":null,"elements":[{"idFluxo":1001,"nome":"Início","documentacao":null,"idDesenho":null,"idType":1,"shortName":"desenhoFluxo.elemento.inicio","elementType":"ElementoFluxoInicioDTO","elementName":"desenhoFluxo.elemento.inicio","group":1,"groupSequence":1,"hasEdge":false,"adjustable":false,"viewOnToolbar":true,"viewProperties":false,"iconWidth":0,"imageName":"StartEvent.png","iconName":"StartEvent_icon.png","propertiesTabs":[{"id":0,"name":"abaElementoFluxo.identificacao"}],"properties":[{"id":"nome","tab":0,"title":"citcorpore.comum.nome","type":"TEXT","subtype":"","ngShow":"","defaultValue":null,"maxLength":50,"width":10,"height":null,"required":true,"identifier":true,"dependencies":[],"options":null},{"id":"documentacao","tab":0,"title":"citcorpore.comum.descricao","type":"EDITOR","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null}],"displayIdentifier":false,"attachToBoundary":[0],"incomingRule":2,"outgoingRule":0,"hasBoundary":false,"identifierOnCenter":false,"tip":"","defaultTab":0,"idSubType":null,"idElemento":2951,"multiplasInstancias":null,"identificador":null,"acaoEntrada":null,"idAcaoEntrada":null,"acaoSaida":null,"idAcaoSaida":null,"tipoInteracao":null,"url":null,"formulario":null,"versaoFormEspecifica":null,"versaoForm":null,"template":null,"permiteEscalar":null,"permiteDelegar":null,"permiteAlterarSituacao":null,"permiteAlterarDados":null,"habilitaNotificacaoEmail":null,"visao":null,"interacao":null,"grupos":null,"usuarios":null,"nomeFluxoEncadeado":null,"script":null,"idRegraNegocio":null,"emiteExcecao":null,"modeloEmail":null,"configCaixaPostal":null,"idCaixaPostal":null,"textoEmail":null,"templateNotificacao":null,"prazoAlerta":null,"intervalo":null,"expressaoCRON":null,"condicaoDisparo":null,"contabilizaSLA":null,"percExecucao":null,"tarefaAprovacao":null,"destinatariosEmail":null,"nomeConexaoBD":null,"nomeObjetoBD":null,"tipoSQL":null,"nomeSQL":null,"jsonEntrada":null,"jsonSaida":null,"executaEntradaNull":null,"recuperaMuitosPraUm":null,"recuperaUmPraMuitos":null,"nomeFluxoEsi":null,"exigeConfirmacao":null,"restTipoParametro":null,"restMetodoHttp":null,"restServicoBuilder":null,"restUrl":null,"restEncode":null,"restTimeout":null,"restVariavelStatus":null,"restParametros":null,"restVariavelRetorno":null,"nomeVariavel":null,"valorVariavel":null,"tipoSolicitacao":null,"solicitante":null,"grupoDirecionamento":null,"relacionada":null,"idContrato":null,"contrato":null,"idServico":null,"servico":null,"idAcordoNivelServico":null,"acordoNivelServicoSLA":null,"impacto":null,"urgencia":null,"objetosBuilder":null,"descricao":null,"contratoDto":null,"servicoDto":null,"acordoNivelServicoDto":null,"posX":128,"posY":68,"largura":32,"altura":32,"label":null,"icone":null,"imagem":null,"larguraPadrao":null,"alturaPadrao":null,"borda":false,"ajustavel":false,"tipoElemento":null,"subTipo":null,"lstPropriedades":null,"propriedades":null,"sequencias":null,"propriedades_serializadas":null,"idElementoBuilder":null,"atribuiAcompanhamento":null,"colAcoes":[],"colAtribuicoes":[],"colConhecimentos":null,"regraNegocioDto":null,"acaoEntradaDto":null,"acaoSaidaDto":null,"idWorkspace":null,"dataVersao":null,"usuario":null,"senha":null,"texto":null,"idElementoOrigem":null,"idPool":null,"replace":false,"ownerElement":null,"height":32,"description":null,"width":32},{"idFluxo":1001,"nome":"Tarefa","documentacao":"","idDesenho":null,"idType":2,"shortName":"desenhoFluxo.elemento.tarefa","elementType":"ElementoFluxoTarefaDTO","elementName":"desenhoFluxo.elemento.tarefa","group":2,"groupSequence":1,"hasEdge":false,"adjustable":false,"viewOnToolbar":true,"viewProperties":true,"iconWidth":0,"imageName":"UserTask.png","iconName":"UserTask_icon.png","propertiesTabs":[{"id":0,"name":"abaElementoFluxo.identificacao"},{"id":1,"name":"abaElementoFluxo.atribuicao"},{"id":2,"name":"abaElementoFluxo.acoesUsuario"},{"id":3,"name":"abaElementoFluxo.acaoEntrada"},{"id":4,"name":"abaElementoFluxo.acaoSaida"},{"id":5,"name":"abaElementoFluxo.interface"},{"id":6,"name":"abaElementoFluxo.baseConhecimento"}],"properties":[{"id":"nome","tab":0,"title":"citcorpore.comum.nome","type":"TEXT","subtype":"","ngShow":"","defaultValue":null,"maxLength":50,"width":10,"height":null,"required":true,"identifier":true,"dependencies":[],"options":null},{"id":"documentacao","tab":0,"title":"citcorpore.comum.descricao","type":"EDITOR","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"multiplasInstancias","tab":0,"title":"desenhoFluxo.tipoInstancia","type":"COMBO","subtype":"","ngShow":"","defaultValue":"N","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"N","title":"desenhoFluxo.tipoInstancia.unica"},{"id":"S","title":"desenhoFluxo.tipoInstancia.varias"},{"id":"U","title":"desenhoFluxo.tipoInstancia.porUsuario"}]},{"id":"identificador","tab":0,"title":"expressao.identificador","type":"IDENTIFIER","subtype":"","ngShow":"","defaultValue":null,"maxLength":100,"width":10,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoEntrada","tab":3,"title":"","type":"EXPRESSION","subtype":"","ngShow":"!${idAcaoEntrada}","defaultValue":null,"maxLength":32000,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idAcaoEntrada","tab":3,"title":"","type":"ENTRYACTION","subtype":"","ngShow":"!${acaoEntrada}","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoSaida","tab":4,"title":"","type":"EXPRESSION","subtype":"","ngShow":"!${idAcaoSaida}","defaultValue":null,"maxLength":32000,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idAcaoSaida","tab":4,"title":"","type":"EXITACTION","subtype":"","ngShow":"!${acaoSaida}","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"tipoInteracao","tab":5,"title":"desenhoFluxo.tipoInteracao","type":"COMBO","subtype":"","ngShow":"","defaultValue":"U","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"U","title":"desenhoFluxo.tipoInteracao.url"},{"id":"B","title":"desenhoFluxo.tipoInteracao.builder"}]},{"id":"formulario","tab":5,"title":"desenhoFluxo.nomeFormulario","type":"AUTOCOMPLETE","subtype":"FormBuilder","ngShow":"${tipoInteracao} == 'B'","defaultValue":null,"maxLength":255,"width":10,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"versaoFormEspecifica","tab":5,"title":"desenhoFluxo.versaoFormEspecifica","type":"COMBO","subtype":"Boolean","ngShow":"${tipoInteracao} == 'B' && ${formulario}","defaultValue":"N","maxLength":null,"width":10,"height":null,"required":false,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"versaoForm","tab":5,"title":"desenhoFluxo.versaoFormulario","type":"AUTOCOMPLETE","subtype":"FormBuilderVersion","ngShow":"${tipoInteracao} == 'B' && ${formulario} && ${versaoFormEspecifica} == 'S'","defaultValue":null,"maxLength":255,"width":10,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"template","tab":5,"title":"desenhoFluxo.template","type":"AUTOCOMPLETE","subtype":"Template","ngShow":"${tipoInteracao} == 'U'","defaultValue":null,"maxLength":null,"width":10,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"permiteEscalar","tab":5,"title":"desenhoFluxo.permiteEscalarAtendimento","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"S","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"permiteDelegar","tab":5,"title":"desenhoFluxo.permiteDelegarAtendimento","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"S","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"permiteAlterarSituacao","tab":5,"title":"desenhoFluxo.permiteAlterarSituacao","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"S","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"permiteAlterarDados","tab":5,"title":"desenhoFluxo.permiteAlterarDados","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"S","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"habilitaNotificacaoEmail","tab":5,"title":"templateSolicitacaoServico.habilitaNotificacaoEmail","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"S","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"visao","tab":5,"title":"desenhoFluxo.tipoInteracao.visao","type":"TEXT","subtype":"","ngShow":"${tipoInteracao} == 'V'","defaultValue":null,"maxLength":255,"width":10,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"contabilizaSLA","tab":0,"title":"desenhoFluxo.contabilizaSLA","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"S","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"percExecucao","tab":0,"title":"desenhoFluxo.percentualExecucao","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"tarefaAprovacao","tab":0,"title":"desenhoFluxo.tarefaAprovacao","type":"COMBO","subtype":"Boolean","ngShow":"","defaultValue":"N","maxLength":null,"width":10,"height":null,"required":true,"identifier":false,"dependencies":[],"options":[{"id":"S","title":"citcorpore.comum.sim"},{"id":"N","title":"citcorpore.comum.nao"}]},{"id":"colAcoes","tab":2,"title":"abaElementoFluxo.acoesUsuario","type":"ACTIONS","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"colAtribuicoes","tab":1,"title":"","type":"ASSIGNMENTS","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"colConhecimentos","tab":6,"title":"","type":"KNOWLEDGE","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoEntradaDto","tab":0,"title":"","type":"DTO","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":0,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoSaidaDto","tab":0,"title":"","type":"DTO","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":0,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null}],"displayIdentifier":true,"attachToBoundary":[0],"incomingRule":0,"outgoingRule":0,"hasBoundary":true,"identifierOnCenter":true,"tip":"","defaultTab":0,"idSubType":null,"idElemento":2952,"multiplasInstancias":"N","identificador":null,"acaoEntrada":null,"idAcaoEntrada":873,"acaoSaida":null,"idAcaoSaida":null,"tipoInteracao":"U","url":null,"formulario":null,"versaoFormEspecifica":"N","versaoForm":null,"template":null,"permiteEscalar":"S","permiteDelegar":"S","permiteAlterarSituacao":"S","permiteAlterarDados":"S","habilitaNotificacaoEmail":"S","visao":null,"interacao":null,"grupos":null,"usuarios":null,"nomeFluxoEncadeado":null,"script":null,"idRegraNegocio":null,"emiteExcecao":null,"modeloEmail":null,"configCaixaPostal":null,"idCaixaPostal":null,"textoEmail":null,"templateNotificacao":null,"prazoAlerta":null,"intervalo":null,"expressaoCRON":null,"condicaoDisparo":null,"contabilizaSLA":"S","percExecucao":null,"tarefaAprovacao":"N","destinatariosEmail":null,"nomeConexaoBD":null,"nomeObjetoBD":null,"tipoSQL":null,"nomeSQL":null,"jsonEntrada":null,"jsonSaida":null,"executaEntradaNull":null,"recuperaMuitosPraUm":null,"recuperaUmPraMuitos":null,"nomeFluxoEsi":null,"exigeConfirmacao":null,"restTipoParametro":null,"restMetodoHttp":null,"restServicoBuilder":null,"restUrl":null,"restEncode":null,"restTimeout":null,"restVariavelStatus":null,"restParametros":null,"restVariavelRetorno":null,"nomeVariavel":null,"valorVariavel":null,"tipoSolicitacao":null,"solicitante":null,"grupoDirecionamento":null,"relacionada":null,"idContrato":null,"contrato":null,"idServico":null,"servico":null,"idAcordoNivelServico":null,"acordoNivelServicoSLA":null,"impacto":null,"urgencia":null,"objetosBuilder":null,"descricao":"","contratoDto":null,"servicoDto":null,"acordoNivelServicoDto":null,"posX":232,"posY":52,"largura":104,"altura":64,"label":null,"icone":null,"imagem":null,"larguraPadrao":null,"alturaPadrao":null,"borda":false,"ajustavel":false,"tipoElemento":null,"subTipo":null,"lstPropriedades":null,"propriedades":null,"sequencias":null,"propriedades_serializadas":null,"idElementoBuilder":null,"atribuiAcompanhamento":null,"colAcoes":[],"colAtribuicoes":[{"idAtribuicao":1641,"idElemento":2952,"tipoConteudoId":1,"idExpressao":125,"tipoAtribuicaoId":1,"tipoDestinatarioId":2,"conteudo":"expression.function.serviceRequest.getCurrentGroup","nome":"serviceRequest.getCurrentGroup","descricao":"expression.function.serviceRequest.getCurrentGroup","script":"serviceRequest.getCurrentGroup();","expressaoDto":{"orderBy":null,"fields":null,"fieldsAlias":null,"showByPage":null,"selectedPage":null,"filters":null,"expressionId":null,"name":"serviceRequest.getCurrentGroup","description":"expression.function.serviceRequest.getCurrentGroup","expressionTypeId":1,"expressionEngineId":2,"returnTypeId":1,"businessRuleEngineId":null,"code":"serviceRequest.getCurrentGroup();","editable":0,"statusId":null,"serviceRequestStatusId":null,"applyToRelease":0,"applyToChange":0,"applyToProblem":0,"applyToServiceRequest":1,"reason":null,"backgroundColor":null,"textColor":null,"statusDto":null,"condition":null,"saveEnabled":null,"expressionReturnType":"STRING","expressionType":"FUNCTION","expressionEngine":"JAVA","businessRuleEngine":null,"serviceRequestStatus":null,"translatedDescription":"expression.function.serviceRequest.getCurrentGroup","process":null,"overwrite":false,"bean":"br.com.centralit.bpm.dto.ExpressionDTO"},"tipoConteudo":"EXPRESSION","tipoAtribuicao":"AUTOMATIC","tipoDestinatario":"GROUP","destinatarios":null}],"colConhecimentos":null,"regraNegocioDto":null,"acaoEntradaDto":{"orderBy":null,"fields":null,"fieldsAlias":null,"showByPage":null,"selectedPage":null,"filters":null,"expressionId":null,"name":"acaoEntradaEncerrarSolicitacao","description":"acaoEntradaEncerrarSolicitacao","expressionTypeId":1,"expressionEngineId":1,"returnTypeId":0,"businessRuleEngineId":1,"code":"var importNames = JavaImporter();\nimportNames.importPackage(Packages.java.util);\nimportNames.importPackage(Packages.java.lang);\nimportNames.importPackage(Packages.java.sql);\nimportNames.importPackage(Packages.br.com.centralit.citcorpore.negocio);\nimportNames.importPackage(Packages.br.com.centralit.citcorpore.integracao);\nimportNames.importPackage(Packages.br.com.centralit.citcorpore.bean);\nimportNames.importPackage(Packages.br.com.citframework.util);\nimportNames.importPackage(Packages.br.com.citframework.comparacao);\nimportNames.importPackage(Packages.br.com.citframework.integracao);\nimportNames.importPackage(Packages.br.com.centralit.bpm.integracao);\nimportNames.importPackage(Packages.br.com.centralit.bpm.dto);\nimportNames.importPackage(Packages.br.com.centralit.citcorpore.bpm.negocio);\nimportNames.importPackage(Packages.br.com.citframework.excecao);\nvar print = java.lang.System.out;\n\nvar execucaoFluxo = params.get(\"execucaoFluxo\");\nvar jdbcEngine = new importNames.JdbcEngine(execucaoFluxo.getTransacao(),null);\n\nmontarSqlIdItemTrabalho = function() {\n\tvar sql = new importNames.StringBuilder();\n\tsql.append(\"select it.iditemtrabalho \")\n\t\t.append(\"from bpm_itemtrabalhofluxo it join bpm_elementofluxo el on it.idelemento = el.idelemento \")\n\t\t.append(\"where it.idinstancia = ? and el.idtype = 2 \")\n\t\t.append(\"order by iditemtrabalho desc \")\n\t\t.append(\"limit 1\");\n\treturn sql.toString();\n}\n\nexecutaConsultaIdItemTrabalho = function(vIdInstancia){\n    var parmsUtilizadosNoSQL = new importNames.ArrayList();\n    parmsUtilizadosNoSQL.add(vIdInstancia);\n    return jdbcEngine.execSQL(montarSqlIdItemTrabalho(), parmsUtilizadosNoSQL.toArray(), 0);\n}\n\nbuscarIdItemTrabalho = function(vIdInstancia){\n\tvar idItem = 0;\n\tvar consultaItemTrabalho = executaConsultaIdItemTrabalho(vIdInstancia);\n\tif (consultaItemTrabalho!=null && !consultaItemTrabalho.isEmpty()){\n\t\tidItem = consultaItemTrabalho.get(0)[0];\n\t}\n\treturn idItem;\n}\n\nmontarSqlEncerraSolicitacao = function(){\n\tvar sql = new importNames.StringBuilder();\n\tsql.append(\"update solicitacaoservico set \")\n\t\t\t\t.append(\"idstatus = 6,\")\n\t\t\t\t.append(\"idtarefaencerramento = ?,\")\n\t\t\t\t.append(\"tempoatendimentohh=0,\")\n\t\t\t\t.append(\"tempoatendimentomm=1,\")\n\t\t\t\t.append(\"tempoatrasohh = 0,\")\n\t\t\t\t.append(\"tempoatrasomm = 0,\")\n\t\t\t\t.append(\"idusuarioresponsavelatual = ?,\")\n\t\t\t\t.append(\"datahorafim = CURRENT_TIMESTAMP \")\n\t   .append(\"where idsolicitacaoservico = ?\");\n\treturn sql.toString();\n}\n\nencerraSolicitacao = function(vIdSolicitacaoServico, vIdTarefa, vUsuarioResponsavel){\n\tvar parmsUtilizadosNoSQL = new importNames.ArrayList();\n\tparmsUtilizadosNoSQL.add(vIdTarefa);\n\tparmsUtilizadosNoSQL.add(vUsuarioResponsavel);\n\tparmsUtilizadosNoSQL.add(vIdSolicitacaoServico);\n\tjdbcEngine.execUpdate(montarSqlEncerraSolicitacao(), parmsUtilizadosNoSQL.toArray());\n\tprint.println(\"---- SolicitacaoServico: \" + vIdSolicitacaoServico);\n}\n\nmontarSqlEncerraInstanciaFluxo = function(){\n\tvar sql = new importNames.StringBuilder();\n\tsql.append(\"update bpm_instanciafluxo set idstatus = 4,\")\n\t\t\t\t\t\t\t\t\t .append(\"datahorafinalizacao = CURRENT_TIMESTAMP \")\n\t   .append(\"where idinstancia = ?\");\n\treturn sql.toString();\n}\n\nencerraInstanciaFluxo = function(vIdInstanciafluxo){\n\tvar parmsUtilizadosNoSQL = new importNames.ArrayList();\n\tparmsUtilizadosNoSQL.add(vIdInstanciafluxo);\n\tjdbcEngine.execUpdate(montarSqlEncerraInstanciaFluxo(), parmsUtilizadosNoSQL.toArray());\n}\n\nmontarSqlEncerraItemTrabalho = function(){\n\tvar sql = new importNames.StringBuilder();\n\tsql.append(\"update bpm_itemtrabalhofluxo set idstatus = 7,\")\n\t\t\t\t\t\t\t\t\t\t.append(\"idresponsavelatual = ?,\")\n\t\t\t\t\t\t\t\t\t\t.append(\"datahorafinalizacao = CURRENT_TIMESTAMP \")\n\t   .append(\"where idinstancia = ? and idstatus in (1,2,3,4)\");\n\treturn sql.toString();\n}\n\nencerraItemTrabalho = function(vIdInstanciafluxo, vUsuarioResponsavel){\n\tvar parmsUtilizadosNoSQL = new importNames.ArrayList();\n\tparmsUtilizadosNoSQL.add(vUsuarioResponsavel);\n\tparmsUtilizadosNoSQL.add(vIdInstanciafluxo);\n\tjdbcEngine.execUpdate(montarSqlEncerraItemTrabalho(), parmsUtilizadosNoSQL.toArray());\n}\n\nmontarSqlBuscaDadosControleSLA = function(){\n\tvar sql = new importNames.StringBuilder();\n\tsql.append(\"select csl.idcontrolesla, csl.datainicial, ss.idcalendario, CURRENT_TIMESTAMP \")\n\t.append(\"from solicitacaoservico ss join controlesla csl on ss.idsolicitacaoservico = csl.idsolicitacaoservico \")\n\t.append(\"where ss.idsolicitacaoservico = ? and (csl.datafinal is null)\");\n\treturn sql.toString();\n}\n\nexecutaConsultaBuscaDadosControleSLA = function(vIdSolicitacaoServico){\n\tvar parmsUtilizadosNoSQL = new importNames.ArrayList();\n\tparmsUtilizadosNoSQL.add(vIdSolicitacaoServico);\n\treturn jdbcEngine.execSQL(montarSqlBuscaDadosControleSLA(), parmsUtilizadosNoSQL.toArray(), 0);\n}\n\nmontarSqlAtualizaControleSLA = function(){\n\tvar sql = new importNames.StringBuilder();\n\tsql.append(\"update controlesla set idstatusfinal = 8, datafinal = ?, tempototal = ? \")\n\t.append(\"where idcontrolesla = ?\");\n\treturn sql.toString();\n}\n\natualizarControleSLA = function(dataFinal, tempoTotal, idControleSLA){\n\tvar parmsUtilizadosNoSQL = new importNames.ArrayList();\n\tparmsUtilizadosNoSQL.add(dataFinal);\n\tparmsUtilizadosNoSQL.add(tempoTotal);\n\tparmsUtilizadosNoSQL.add(idControleSLA);\n\tjdbcEngine.execUpdate(montarSqlAtualizaControleSLA(), parmsUtilizadosNoSQL.toArray());\n}\n\ncalculaTempoTotalCalendario = function(idCalendario, dti, dtf){\n\tvar calendarioServiceEjb = new importNames.CalendarioServiceEjb();\n\tif (dtf == null) {\n\t\tdtf = importNames.UtilDatas.getDataHoraAtual();\n\t}\n\tvar calculoJornadaDTO = new importNames.CalculoJornadaDTO(idCalendario,dti,dtf);\n\tcalculoJornadaDTO = calendarioServiceEjb.calculaTempoDecorridoHHMMSSPelaJornadaDeTrabalho(calculoJornadaDTO, tc);\n\treturn (calculoJornadaDTO.getTempoDecorridoTotalEmSegundos()!=null)?calculoJornadaDTO.getTempoDecorridoTotalEmSegundos():0;\n}\n\nfinalizarControleSLA = function(rControleSLA){\n\tvar controleSlaServiceEjb = new importNames.ControleSlaServiceEjb();\n\tvar tempoTotal = calculaTempoTotalCalendario(rControleSLA[2], rControleSLA[1], rControleSLA[3]);\n\tatualizarControleSLA(rControleSLA[3], tempoTotal, rControleSLA[0]);\n}\n\nencerrarControleSLA = function (vIdSolicitacaoServico){\n\tvar listaControleSLAabertos = executaConsultaBuscaDadosControleSLA(vIdSolicitacaoServico);\n\tvar rControleSLA = null;\n\tif((listaControleSLAabertos!=null)&&(listaControleSLAabertos.size()>0)){\n\t\tfor (var itElementos = listaControleSLAabertos.iterator(); itElementos.hasNext();){\n\t\t\trControleSLA = itElementos.next();\n\t\t\tif ((rControleSLA!=null) && (rControleSLA[0]!=null) && (rControleSLA[1]!=null)){\n\t\t\t\tfinalizarControleSLA(rControleSLA);\n\t\t\t\tprint.println(\"ContorleSLA Finalizado: \" + rControleSLA[0]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nrealizarEncerramentoSolicitacao = function (){\n\ttry {\n\t\tvar solicitacaoServicoDto = params.get(\"solicitacaoServico\");\n\t\tvar instanciafluxo = params.get(\"instanciafluxo\");\n\t\tvar vIdInstanciafluxo = instanciafluxo.getIdInstancia();\n\t\tvar vIdSolicitacaoServico = solicitacaoServicoDto.getIdSolicitacaoServico();\n\t\tvar vIdTarefa = buscarIdItemTrabalho(vIdInstanciafluxo);\n\t\tvar vUsuarioResponsavel = solicitacaoServicoDto.getIdResponsavel();\n\t\tsolicitacaoServicoDto.setIdStatus(6);\n\t\tencerraSolicitacao(vIdSolicitacaoServico, vIdTarefa, vUsuarioResponsavel);\n\t\tencerraInstanciaFluxo(vIdInstanciafluxo);\n\t\tencerraItemTrabalho(vIdInstanciafluxo, vUsuarioResponsavel);\n\t\tencerrarControleSLA(vIdSolicitacaoServico);\n\t} catch (err) {\n        print.println(\"Problema ao finalizar solicitacao.\\n\");\n\t\tprint.println(err);\n    }\n}\n\nrealizarEncerramentoSolicitacao();","editable":1,"statusId":null,"serviceRequestStatusId":null,"applyToRelease":1,"applyToChange":1,"applyToProblem":1,"applyToServiceRequest":1,"reason":null,"backgroundColor":null,"textColor":null,"statusDto":null,"condition":null,"saveEnabled":null,"expressionReturnType":"NONE","expressionType":"FUNCTION","expressionEngine":"RHINO","businessRuleEngine":"ITSM","serviceRequestStatus":null,"translatedDescription":"acaoEntradaEncerrarSolicitacao","process":null,"overwrite":false,"bean":"br.com.centralit.bpm.dto.ExpressionDTO"},"acaoSaidaDto":null,"idWorkspace":null,"dataVersao":null,"usuario":null,"senha":null,"texto":null,"idElementoOrigem":null,"idPool":null,"replace":false,"ownerElement":null,"height":64,"description":"","width":104},{"idFluxo":1001,"nome":"Finalização","documentacao":null,"idDesenho":null,"idType":7,"shortName":"desenhoFluxo.elemento.finalizacao","elementType":"ElementoFluxoFinalizacaoDTO","elementName":"desenhoFluxo.elemento.finalizacao","group":1,"groupSequence":99,"hasEdge":false,"adjustable":false,"viewOnToolbar":true,"viewProperties":false,"iconWidth":0,"imageName":"EndEvent.png","iconName":"EndEvent_icon.png","propertiesTabs":[{"id":0,"name":"abaElementoFluxo.identificacao"}],"properties":[{"id":"nome","tab":0,"title":"citcorpore.comum.nome","type":"TEXT","subtype":"","ngShow":"","defaultValue":null,"maxLength":50,"width":10,"height":null,"required":true,"identifier":true,"dependencies":[],"options":null},{"id":"documentacao","tab":0,"title":"citcorpore.comum.descricao","type":"EDITOR","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null}],"displayIdentifier":false,"attachToBoundary":[0],"incomingRule":0,"outgoingRule":2,"hasBoundary":false,"identifierOnCenter":false,"tip":"","defaultTab":0,"idSubType":null,"idElemento":2953,"multiplasInstancias":null,"identificador":null,"acaoEntrada":null,"idAcaoEntrada":null,"acaoSaida":null,"idAcaoSaida":null,"tipoInteracao":null,"url":null,"formulario":null,"versaoFormEspecifica":null,"versaoForm":null,"template":null,"permiteEscalar":null,"permiteDelegar":null,"permiteAlterarSituacao":null,"permiteAlterarDados":null,"habilitaNotificacaoEmail":null,"visao":null,"interacao":null,"grupos":null,"usuarios":null,"nomeFluxoEncadeado":null,"script":null,"idRegraNegocio":null,"emiteExcecao":null,"modeloEmail":null,"configCaixaPostal":null,"idCaixaPostal":null,"textoEmail":null,"templateNotificacao":null,"prazoAlerta":null,"intervalo":null,"expressaoCRON":null,"condicaoDisparo":null,"contabilizaSLA":null,"percExecucao":null,"tarefaAprovacao":null,"destinatariosEmail":null,"nomeConexaoBD":null,"nomeObjetoBD":null,"tipoSQL":null,"nomeSQL":null,"jsonEntrada":null,"jsonSaida":null,"executaEntradaNull":null,"recuperaMuitosPraUm":null,"recuperaUmPraMuitos":null,"nomeFluxoEsi":null,"exigeConfirmacao":null,"restTipoParametro":null,"restMetodoHttp":null,"restServicoBuilder":null,"restUrl":null,"restEncode":null,"restTimeout":null,"restVariavelStatus":null,"restParametros":null,"restVariavelRetorno":null,"nomeVariavel":null,"valorVariavel":null,"tipoSolicitacao":null,"solicitante":null,"grupoDirecionamento":null,"relacionada":null,"idContrato":null,"contrato":null,"idServico":null,"servico":null,"idAcordoNivelServico":null,"acordoNivelServicoSLA":null,"impacto":null,"urgencia":null,"objetosBuilder":null,"descricao":null,"contratoDto":null,"servicoDto":null,"acordoNivelServicoDto":null,"posX":412,"posY":68,"largura":32,"altura":32,"label":null,"icone":null,"imagem":null,"larguraPadrao":null,"alturaPadrao":null,"borda":false,"ajustavel":false,"tipoElemento":null,"subTipo":null,"lstPropriedades":null,"propriedades":null,"sequencias":null,"propriedades_serializadas":null,"idElementoBuilder":null,"atribuiAcompanhamento":null,"colAcoes":[],"colAtribuicoes":[],"colConhecimentos":null,"regraNegocioDto":null,"acaoEntradaDto":null,"acaoSaidaDto":null,"idWorkspace":null,"dataVersao":null,"usuario":null,"senha":null,"texto":null,"idElementoOrigem":null,"idPool":null,"replace":false,"ownerElement":null,"height":32,"description":null,"width":32}],"connections":[{"idFluxo":1001,"nome":null,"documentacao":null,"idDesenho":null,"idType":0,"shortName":"desenhoFluxo.conexao","elementType":"SequenciaFluxoDTO","elementName":"desenhoFluxo.conexao","group":7,"groupSequence":0,"hasEdge":false,"adjustable":false,"viewOnToolbar":false,"viewProperties":true,"iconWidth":0,"imageName":"SequenciaFluxoDTO.png","iconName":"","propertiesTabs":[{"id":0,"name":"abaElementoFluxo.identificacao"}],"properties":[{"id":"nome","tab":0,"title":"citcorpore.comum.nome","type":"TEXT","subtype":"","ngShow":"","defaultValue":null,"maxLength":50,"width":10,"height":null,"required":true,"identifier":true,"dependencies":[],"options":null},{"id":"idCondicao","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"condicao","tab":0,"title":"","type":"TEXTAREA","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idAcao","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acao","tab":0,"title":"","type":"TEXTAREA","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idStatus","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idElemento","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"condicaoEditavel","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"negarCondicao","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoEditavel","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoDto","tab":0,"title":"","type":"EXPRESSION","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"condicaoDto","tab":0,"title":"","type":"EXPRESSION","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"statusDto","tab":0,"title":"","type":"EXPRESSION","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null}],"displayIdentifier":false,"attachToBoundary":[0],"incomingRule":0,"outgoingRule":0,"hasBoundary":false,"identifierOnCenter":false,"tip":"","defaultTab":1,"idElementoOrigem":2951,"idElementoDestino":2952,"idConexaoOrigem":1,"idConexaoDestino":3,"idCondicao":null,"condicao":null,"idAcao":null,"acao":null,"idStatus":null,"idElemento":null,"idDesenhoOrigem":null,"idDesenhoDestino":null,"bordaX":196,"bordaY":84,"posicaoAlterada":"N","condicaoEditavel":null,"negarCondicao":null,"negarCondicaoBoolean":null,"acaoEditavel":null,"acaoDto":null,"condicaoDto":null,"statusDto":null},{"idFluxo":1001,"nome":null,"documentacao":null,"idDesenho":null,"idType":0,"shortName":"desenhoFluxo.conexao","elementType":"SequenciaFluxoDTO","elementName":"desenhoFluxo.conexao","group":7,"groupSequence":0,"hasEdge":false,"adjustable":false,"viewOnToolbar":false,"viewProperties":true,"iconWidth":0,"imageName":"SequenciaFluxoDTO.png","iconName":"","propertiesTabs":[{"id":0,"name":"abaElementoFluxo.identificacao"}],"properties":[{"id":"nome","tab":0,"title":"citcorpore.comum.nome","type":"TEXT","subtype":"","ngShow":"","defaultValue":null,"maxLength":50,"width":10,"height":null,"required":true,"identifier":true,"dependencies":[],"options":null},{"id":"idCondicao","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"condicao","tab":0,"title":"","type":"TEXTAREA","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idAcao","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acao","tab":0,"title":"","type":"TEXTAREA","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":10,"height":60,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idStatus","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"idElemento","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"condicaoEditavel","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"negarCondicao","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoEditavel","tab":0,"title":"","type":"INTEGER","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":5,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"acaoDto","tab":0,"title":"","type":"EXPRESSION","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"condicaoDto","tab":0,"title":"","type":"EXPRESSION","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null},{"id":"statusDto","tab":0,"title":"","type":"EXPRESSION","subtype":"","ngShow":"","defaultValue":null,"maxLength":null,"width":12,"height":null,"required":false,"identifier":false,"dependencies":[],"options":null}],"displayIdentifier":false,"attachToBoundary":[0],"incomingRule":0,"outgoingRule":0,"hasBoundary":false,"identifierOnCenter":false,"tip":"","defaultTab":1,"idElementoOrigem":2952,"idElementoDestino":2953,"idConexaoOrigem":1,"idConexaoDestino":3,"idCondicao":null,"condicao":null,"idAcao":null,"acao":null,"idStatus":null,"idElemento":null,"idDesenhoOrigem":null,"idDesenhoDestino":null,"bordaX":374,"bordaY":84,"posicaoAlterada":"N","condicaoEditavel":null,"negarCondicao":null,"negarCondicaoBoolean":null,"acaoEditavel":null,"acaoDto":null,"condicaoDto":null,"statusDto":null}],"integradoAoBuilder":null,"idFluxoBuilder":null,"idProcesso":1,"processo":"SERVICE_REQUEST","replace":false,"permiteReabertura":"S"}